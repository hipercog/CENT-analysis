library(plyr)
setwd('C:\\Users\\admin_cent\\Dropbox\\PROJECT_CENT\\CENT_Publications\\WIP - NFB clinical trial - Edua gradu\\R')
pth <- 'C:\\Users\\admin_cent\\Dropbox\\PROJECT_CENT\\CENT_patients\\CENT_DB_2013-08-27\\AutoGenerated\\'
blk <- read.csv(paste0(pth, 'auto_block.csv'), sep=";")
blk <- droplevels(subset(blk, session_num<41 & score!=0))
ssn <- read.csv(paste0(pth, 'auto_session.csv'), sep=";")
mta <- read.csv(paste0(pth, 'meta_data.csv'), sep=";")
dsl <- read.csv(paste0(pth, 'daily_session_wLatencyCalculation.csv'), sep=";")
nfb <- read.csv('test_outcomes.csv', sep="\t")
tb <- unique(subset(nfb$Part_number, nfb$TB.1.SMR1 == -1))
smr <- unique(subset(nfb$Part_number, nfb$TB.1.SMR1 == 1))
men <- unique(subset(nfb$Part_number, nfb$Female0.Male2 == 2))
wmn <- unique(subset(nfb$Part_number, nfb$Female0.Male2 == 0))
ssn.tb.men <- droplevels(subset(ssn, patient%in%tb & patient%in%men))
ssn.smr.men <- droplevels(subset(ssn, patient%in%smr & patient%in%men))
ssn.tb.wmn <- droplevels(subset(ssn, patient%in%tb & patient%in%wmn))
ssn.smr.wmn <- droplevels(subset(ssn, patient%in%smr & patient%in%wmn))
dsl.tb.men <- droplevels(subset(dsl, patient%in%tb & patient%in%men))
dsl.smr.men <- droplevels(subset(dsl, patient%in%smr & patient%in%men))
dsl.tb.wmn <- droplevels(subset(dsl, patient%in%tb & patient%in%wmn))
dsl.smr.wmn <- droplevels(subset(dsl, patient%in%smr & patient%in%wmn))
bwrc <- palette(c('#F0AA00','#00A0BE','#003C78','#828282','#F0F0F0','#B4BE00','#FA4100'))
sex = c("female", "male")
protocol = c("TB","null", "SMR")
par(mfrow=c(5,5))
df <- droplevels(subset(dsl.tb.men, exclude==0))
pnums <- unique(df$patient)
for (i in 1:length(pnums)){
p <- pnums[i]
tmp <- df #outgoners(df, df$adj_score, thr=3)
tmp <- droplevels(subset(tmp, patient==p))
quad <- with(tmp, fitted(lm(adj_score ~ session_num + I(session_num^2))))
# ttl = paste("Participant", p, ",", sex[nfb[nfb$Part_number==p,]$Gender..1.F..2.M.], ",", protocol[nfb[nfb$Part_number==p,]$TB1.SMR3])
plot(tmp, main=p, xlab="", ylab="", col=2)
lines(quad, col=3, lwd=2)
}
for (i in 1:length(pnums)){
p <- pnums[i]
tmp <- df #outgoners(df, df$adj_score, thr=3)
tmp <- droplevels(subset(tmp, patient==p))
quad <- with(tmp, fitted(lm(adj_score ~ session_num + I(session_num^2))))
# ttl = paste("Participant", p, ",", sex[nfb[nfb$Part_number==p,]$Gender..1.F..2.M.], ",", protocol[nfb[nfb$Part_number==p,]$TB1.SMR3])
plot(tmp, main=p, ylab="", col=2)
lines(quad, col=3, lwd=2)
}
for (i in 1:length(pnums)){
p <- pnums[i]
tmp <- df #outgoners(df, df$adj_score, thr=3)
tmp <- droplevels(subset(tmp, patient==p))
quad <- with(tmp, fitted(lm(adj_score ~ session_num + I(session_num^2))))
# ttl = paste("Participant", p, ",", sex[nfb[nfb$Part_number==p,]$Gender..1.F..2.M.], ",", protocol[nfb[nfb$Part_number==p,]$TB1.SMR3])
plot(tmp, main=p, col=2)
lines(quad, col=3, lwd=2)
}
for (i in 1:length(pnums)){
p <- pnums[i]
tmp <- df #outgoners(df, df$adj_score, thr=3)
tmp <- droplevels(subset(tmp, patient==p))
quad <- with(tmp, fitted(lm(adj_score ~ session_num + I(session_num^2))))
# ttl = paste("Participant", p, ",", sex[nfb[nfb$Part_number==p,]$Gender..1.F..2.M.], ",", protocol[nfb[nfb$Part_number==p,]$TB1.SMR3])
plot(tmp, main=p, col=2)
lines(quad, col=3, lwd=2)
}
df <- droplevels(subset(dsl.tb.men, exclude==0))
pnums <- unique(df$patient)
for (i in 1:length(pnums)){
p <- pnums[i]
tmp <- df #outgoners(df, df$adj_score, thr=3)
tmp <- droplevels(subset(tmp, patient==p))
quad <- with(tmp, fitted(lm(adj_score ~ session_num + I(session_num^2))))
plot(tmp, main=p, col=2)
lines(quad, col=3, lwd=2)
}
df <- droplevels(subset(dsl.tb.men, exclude==0))
pnums <- unique(df$patient)
for (i in 1:length(pnums)){
p <- pnums[i]
tmp <- df #outgoners(df, df$adj_score, thr=3)
tmp <- droplevels(subset(tmp, patient==p))
quad <- with(tmp, fitted(lm(adj_score ~ session_num + I(session_num^2))))
plot(tmp, main=p, col=2)
lines(quad, col=3, lwd=2)
}
